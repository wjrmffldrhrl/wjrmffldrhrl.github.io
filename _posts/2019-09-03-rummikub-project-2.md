---
title:  "루미큐브 프로젝트 -2-"
categories:
  - Project
tags: 
  - Rummikub
  
header:
  image: /assets/images/rummikub_title.png
  teaser: /assets/images/rummikub_title.png
---  


# 순서도 & 블록도  

설계 주제도 잡히고 어떤 기능을 중점적으로 제작할지 계획도 세웠다.  
본격적인 제작에 들어가기 전에 순서도와 블록도를 만들어 보고 시작하기로 했다.  

## 개략 순서도  
![flow1]({{ site.baseurl }}/assets/images/rummikub_2/flow_chart1.png)  



세부적인 순서도를 만들기 전에 전체적인 움직임을 파악하기 위해 간략한 순서도를 만들었다.  

서버와 클라이언트가 통신하면서 게임을 진행하는 방식이고 왠만한 데이터 관리와 게임 진행은 서버에서 담당하기로 했다.  

지금 봐도 생각보다 만족스러운 순서도이다.  

실제로 완성됐을때도 순서도에서 보여주는 것처럼 서버에서 플레이 카드를 모두 만들어서
클라이언트에게 전송하는 방식으로 작동하였다.  


## 블록도  
![block]({{ site.baseurl }}/assets/images/rummikub_2/block_chart.png)  


이 블록도를 만들때도 그랬지만 아직도 햇갈린다.  
순서도와 블록도의 차이점이 무엇인지...  

지금 내가 생각하는 블록도와 순서도의 차이점은  
순서도는 프로세스가 작동하는 흐름을 표현하는 말그대로 진행 순서를 표현하는것이고 블록도는 프로세스가 작동할때 데이터의 이동과 그러한 데이터들의 종류를 보여준다고 생각한다.  

그때도 대충 이런식으로 생각했기 때문에 블럭에서 블럭으로(함수에서 함수로) 넘어가는 데이터가 어떤 데이터이고 얼마나 가고 어느 방향으로 가는지 표현하려고 애쓴 것 같다.  

~~그래도 아직도 햇갈림~~  

## 세부 기능 순서도  

세부 기능 순서도는 전 단계에서 제작한 개략 순서도를 바탕으로 좀더 세부적인 기능들을 순서도로 표현해 봤다.  

전에 눈여겨 본 4가지 중요 규칙들을 바탕으로 세부 기능을 구성하였다.  
>1. 106개의 1부터 13까지 숫자가 적혀있는 4가지 색깔의 패 두벌
>2. 조커 2개
>3. 족보(같은색으로 연속되는 숫자 or 똑같은 숫자 다른 색깔)
>4. 등록  

### 106개의 카드 생성

1부터 13까지의 숫자가 적혀있는 4가지 색깔의 패 (52개) 두벌 (52 X 2 = 104) 그리고 조커 2개  

총 106개의 카드를 생성해야 하며 생성된 카드를 랜덤하게 섞어놓고 시작한다.  

#### 카드 생성  

![open]({{ site.baseurl }}/assets/images/rummikub_2/opencard.png)  

으... 그때 만들때도 느꼈지만 너무 지저분하고 길게 만들었다.  

3중 for문으로 하려고 하다보니 이런식으로 만들어 졌는데 지금 생각해보면 중첩된 반복문은 조금 간단하게 표현하고 작고 필요한 정보들만 넣는게 좋았을듯 싶다.  

카드는 구조체로 만들었고 카드 하나는 다음과 같은 정보들을 담고있다.  
1. 색
2. 숫자
3. 조커  

~~~cpp
struct Card {
  int num;// 숫자 1~13
  int color; // 색 1~4
  int joker; // 1 or 2
};
~~~  

그리고 이러한 카드가 총 106개  

~~~cpp
Card c[106];
~~~  

생성된 카드에 정보를 집어넣어 준다.  

~~~cpp
void opencard(card c[106])
{
	int i, j, k, n = 0;
	for (k = 0; k < 2; k++)
	{
		for (i = 1; i <= 4; i++)
		{
			for (j = 1; j <= 13; j++)
			{
				c[n].color = i;
				c[n].num = j;
				n++;
			}
		}
	}
	c[n].joker = c[n + 1].joker = 1;//조커넣기

}
~~~  

위의 함수를 나중에 게임이 시작될때 호출해 주면 된다.  

#### 카드 섞기


![shuffle]({{ site.baseurl }}/assets/images/rummikub_2/shuffle.png)  


카드를 섞어주는 함수의 순서도이다.  

A카드와 B카드의 위치를 바꿔주는 swap함수를 호출하여 첫번째 카드와 렌덤한 106개의 카드중 하나의 카드를 바꾸고 두번째 세번째... 계속해서 그 과정을 106번 반복한다.  

그러면 모든 카드를 섞을 수 있다.  

~~~cpp
void swap(card *a, card *b)//카드를 바꿔주는 함수
{
	card tmp;
	tmp = *a;
	*a = *b;
	*b = tmp;
}

void shuffle(card *c)//카드를 섞어주는 함수
{
	int i, j;

	srand(time(NULL));
	for (i = 0; i<106; i++)
	{
		j = rand() % 106;
		swap(c + i, c + j);
	}
}
~~~  

opencard 함수를 호출한 뒤 위의 함수를 호출해주면 된다.  


